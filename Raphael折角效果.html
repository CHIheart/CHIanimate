<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Examples</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link href="" rel="stylesheet">
<style>
*{margin:0;padding:0;}
#Canvas{
	background-color:#ffac13;
	width:300px;
	height:300px;
	position:relative;
}

</style>
</head>
<body>
<div id="Canvas">
</div>
</body>
</html>
<script src="http://apps.bdimg.com/libs/raphael/2.1.2/raphael-min.js"></script>
<!-- <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script> -->
<script>
var paper=Raphael("Canvas",300,300);
function triangleShadowExpand(x1,y1,x2,y2,x3,y3,x0,y0)
{
	var path=Raphael.format("M{0},{1}L{2},{3}L{4},{5}Z",x1,y1,x2,y2,x3,y3),
		p0=Raphael.format("M{0},{1}L{0},{1}L{0},{1}Z",x0,y0),
		p_=paper.path(p0).attr({stroke:false,fill:"rgba(255,255,255,.5)"}),
		p=paper.path(p0).attr({stroke:false,fill:"rgba(0,0,0,.5)"}).animate({path:path},1000,">").onAnimation(function(a1){
			var curpath=this.attr("path");
			var d1=curpath[0],
				x1=d1[1],
				y1=d1[2],
				d2=curpath[1],
				x2=d2[1],
				y2=d2[2],
				d3=curpath[2],
				x3=d3[1],
				y3=d3[2],
				b=x1==x2;
			p_.attr({path:Raphael.format("M{0},{1}L{2},{3}L{4},{5}Z",x0,y0,x1,y1,b?x3:x2,b?y3:y2)});
	
		});
}

flipShadow(0,0,150,0,0,100);
flipShadow(300,300,300,150,150,300);

function flipShadow(ox,oy,h1x,h1y,h2x,h2y)
{
	var o=[ox,oy],
		h1=[h1x,h1y],
		h2=[h2x,h2y],
		module=function(vec){
			return Math.sqrt(vec[0]*vec[0] + vec[1]*vec[1]);
		},
		fix=function(n){
			return n.toFixed(2);
		},
		v_oh1=[h1[0]-o[0],h1[1]-o[1]],
		m_oh1=module(v_oh1),
		v_oh2=[h2[0]-o[0],h2[1]-o[1]],
		m_oh2=module(v_oh2),
		v_h1h2=[h2[0]-h1[0],h2[1]-h1[1]],
		m_h1h2=module(v_h1h2),
		m_op=m_oh1*m_oh2/m_h1h2,
		m_og=2*m_op,
		v_og_n=[-v_h1h2[1],v_h1h2[0]],//[x,y]垂直于[-y,x]
		m_og_n=module(v_og_n),
		uv_og=[v_og_n[0]/m_og_n,v_og_n[1]/m_og_n],
		v_og_1=[uv_og[0]*m_og,uv_og[1]*m_og],
		v_og_2=[-v_og_1[0],-v_og_1[1]],
		g1=[v_og_1[0]+o[0],v_og_1[1]+o[1]],
		g2=[v_og_2[0]+o[0],v_og_2[1]+o[1]],
		v_h1g1=[g1[0]-h1[0],g1[1]-h1[1]],
		m_h1g1=module(v_h1g1),
		g=fix(m_h1g1)==fix(m_oh1) ? g1: g2,
		path_g=Raphael.format("M{0},{1}L{2},{3}L{4},{5}Z",h1x,h1y,h2x,h2y,g[0],g[1]),
		path_0=Raphael.format("M{0},{1}L{0},{1}L{0},{1}Z",ox,oy),
		path_shadow=paper.path(path_0).attr({stroke:false,fill:"rgba(255,255,255,.3)"}).data("id",Math.random());
		paper.path(path_0).attr({stroke:false,fill:"rgba(0,0,0,.3)"}).animate({path:path_g},1000,">").onAnimation(function(a1){
			var curpath=this.attr("path"),
				d1=curpath[0],
				x1=d1[1],
				y1=d1[2],
				d2=curpath[1],
				x2=d2[1],
				y2=d2[2],
				d3=curpath[2],
				x3=d3[1],
				y3=d3[2],
				b=x1==x2;
			path_shadow.attr({path:Raphael.format("M{0},{1}L{2},{3}L{4},{5}Z",ox,oy,x1,y1,b?x3:x2,b?y3:y2)});
		});
}


</script>